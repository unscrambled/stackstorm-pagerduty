---
name: "ack"
pack: "pagerduty"
action_ref: "pagerduty.acknowledge_incident"
description: "Ack an Incident"
formats:
  - "ack {{event_keys}}"
ack:
  format: "Ok, I'm on it!"
result:
  format: |
    {% if execution.status == 'succeeded' %}
    Incidents acknowledged:{~}
    {% for id, incident in execution.result.result.acknowledged.iteritems() %}
    {% acknowledgement = incident.acknowledgements[-1] %}
    [{{id}}] {{incident.description}} ack'd at {{acknowledgement.at}}
    {% endfor %}
    {% elif execution.result.result.error.type == 'UnknownUser' %}
    Oops! {{execution.result.result.error.message}}
    {% else %}
    Error: {{execution.result.result.error.message}}. See `{{execution.id}}` for more details.
    {% endif %}
